{% extends "glims/dashboard.html" %}
{% load crispy_forms_tags %}
{% block page %}Pools{% endblock %}
{% block breadcrumbs %}<a href="{% url 'pools' %}">Pools</a> / {{pool.name}} {% endblock %}
{% block content %}
<script src="/static/js/pages/pool.js"></script>
<div class="row">
      <div class="col-lg-12">
        <div class="widget">
          <div class="widget-header">
            <i class="fa fa-rocket"></i> {{pool.name}}
             <a href="{% url 'delete_pool' pk=pool.id %}" onClick="if(!confirm('Are you sure you want to delete this pool'))return false;" class="btn btn-sm btn-danger pull-right">Delete</a>
          </div>
          <div class="widget-body">
          <div ng-controller="PoolController" ng-init="init({pool_id:{{pool.id}}})">
		  <div angular-ajax-form url="{% url 'update_pool' pk=pool.id %}" prefix="pool" on-error="onError" on-success="onSuccess">
	          {% crispy form form.helper %}
	          <button ng-click="submit()" class="btn btn-default">Submit</button>
          </div>
          </div>
          
              <!-- 
              <table class="table">
              	<tbody>
					<tr><th>Type</th><td>{{pool.type}}</td></tr>
                	<tr><th>Description</th><td>{{pool.description}}</td></tr>
                	{% for k,v in pool.data.items %}
                	<tr><th>{{k}}</th><td>{{v}}</td></tr>
                	{% endfor %}
                </tbody>
              </table>
               -->

	<script type="text/ng-template" id="myModalContent.html">
		<div class="modal-header">
            <h3 class="modal-title">{[sample.name]}</h3>
        </div>
        <div class="modal-body">
			{[sample_data]}
			{[override]}
        	<div style="padding:25px;">{% crispy sample_form sample_form.helper %}</div>    
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">OK</button>
            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
        </div>
    </script>
    {% include 'glims/partials/sample_modal.html' %}
	
             <div ng-controller="SamplesController" ng-init="init({pool_id:{{pool.id}}})">
				<h3>Samples <button class="pull-right btn btn-sm btn-success" ng-click="openSampleModal();">Add</button></h3>
				
				<h4 ng-hide="samples.length">There are no samples associated with this project</h4>
				<table class="table" ng-show="samples.length">
              	<thead><tr><td>ID</td><td>Name</td><td>Description</td><td>Overridden Fields</td><td></td></tr></thead>
              	<tbody>
                	<tr ng-repeat="s in samples">
                		<td ng-if="s.editing"><input ng-model="s.sample_id" value="{[s.sample_id]}" placeholder="(required) Enter sample id"/></td><td ng-if="!s.editing"><a href="{[ sampleLink(s) ]}">{[s.sample_id]}</a></td>
                		<td ng-if="s.editing"><input ng-model="s.name" value="{[s.name]}" placeholder="(required) Enter sample name"/></td><td ng-if="!s.editing">{[s.name]}</td>
                		<td ng-if="s.editing"><textarea ng-model="s.description" placeholder="(Optional) Enter a description">{[s.description]}</textarea></td><td ng-if="!s.editing">{[s.description]}</td>
                		<td>{[overriddenFields(s)]}</span></td>
                		<td>
                			<button class="btn btn-danger" ng-click="removeSample(s,$index)">Remove</button>
                			<button class="btn btn-default" ng-click="open(s,'lg')">Edit</button>	
                		</td>
                	</tr>
                </tbody>
              </table>
			</div>
          </div>
        </div>
      </div>
{% endblock %}